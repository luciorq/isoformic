<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Run Gene Set Enrichment Analysis for Different Transcript Types — run_enrichment • isoformic</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run Gene Set Enrichment Analysis for Different Transcript Types — run_enrichment"><meta name="description" content="Performs gene set enrichment analysis (GSEA) on differential expression results for various transcript types,
using the fgsea package. The function iterates over specified transcript types, filters the data accordingly,
and runs GSEA for each type."><meta property="og:description" content="Performs gene set enrichment analysis (GSEA) on differential expression results for various transcript types,
using the fgsea package. The function iterates over specified transcript types, filters the data accordingly,
and runs GSEA for each type."><meta property="og:image" content="https://luciorq.github.io/isoformic/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">isoformic</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2.9013</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/isoformic-intro.html">Isoformic: Isoform-level biological interpretation of transcriptomic data</a></li>
    <li><a class="dropdown-item" href="../articles/isoformic-preprocess.html">isoformic-preprocess</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/luciorq/isoformic/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Run Gene Set Enrichment Analysis for Different Transcript Types</h1>
      <small class="dont-index">Source: <a href="https://github.com/luciorq/isoformic/blob/HEAD/R/run_enrichment.R" class="external-link"><code>R/run_enrichment.R</code></a></small>
      <div class="d-none name"><code>run_enrichment.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs gene set enrichment analysis (GSEA) on differential expression results for various transcript types,
using the <code>fgsea</code> package. The function iterates over specified transcript types, filters the data accordingly,
and runs GSEA for each type.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_enrichment</span><span class="op">(</span></span>
<span>  <span class="va">det_df</span>,</span>
<span>  <span class="va">genesets_list</span>,</span>
<span>  <span class="va">tx_to_gene</span>,</span>
<span>  pval_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  lfc_cutoff <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-det-df">det_df<a class="anchor" aria-label="anchor" href="#arg-det-df"></a></dt>
<dd><p>A <code>data.frame</code> or <code>tibble</code> containing transcript-level differential expression results,
including <code>transcript_type</code>, <code>log2FC</code>, and <code>gene_name</code> columns.</p></dd>


<dt id="arg-genesets-list">genesets_list<a class="anchor" aria-label="anchor" href="#arg-genesets-list"></a></dt>
<dd><p>A list of gene sets to be used in the enrichment analysis.</p></dd>


<dt id="arg-tx-to-gene">tx_to_gene<a class="anchor" aria-label="anchor" href="#arg-tx-to-gene"></a></dt>
<dd><p>A <code>data.frame</code> or <code>tibble</code> mapping transcript names to gene names, including <code>transcript_name</code> and <code>gene_name</code> columns.</p></dd>


<dt id="arg-pval-cutoff">pval_cutoff<a class="anchor" aria-label="anchor" href="#arg-pval-cutoff"></a></dt>
<dd><p>A numeric value specifying the p-value cutoff for the enrichment results. Default is <code>0.05</code>.</p></dd>


<dt id="arg-lfc-cutoff">lfc_cutoff<a class="anchor" aria-label="anchor" href="#arg-lfc-cutoff"></a></dt>
<dd><p>A numeric value specifying the log2 fold-change cutoff for filtering transcripts. Default is <code>1</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>tibble</code> containing the enrichment analysis results for each transcript type, including pathway names,
p-values, adjusted p-values, and the transcript type (experiment).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function defines a list of transcript types and their corresponding labels.
It then filters the input differential expression data for each transcript type, ranks the genes by log2 fold-change,
and performs GSEA using the <code>fgsea</code> package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Sample differential expression data</span></span></span>
<span class="r-in"><span><span class="va">det_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  gene_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"GeneA"</span>, <span class="st">"GeneB"</span>, <span class="st">"GeneC"</span>, <span class="st">"GeneD"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"GeneA"</span>, <span class="st">"GeneA"</span>, <span class="st">"GeneB"</span>, <span class="st">"GeneC"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"GeneD"</span>, <span class="st">"GeneE"</span>, <span class="st">"GeneB"</span>, <span class="st">"GeneA"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  transcript_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"protein_coding"</span>, <span class="st">"retained_intron"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"protein_coding_CDS_not_defined"</span>, <span class="st">"processed_transcript"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"protein_coding"</span>, <span class="st">"protein_coding"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"retained_intron"</span>, <span class="st">"protein_coding_CDS_not_defined"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"processed_transcript"</span>, <span class="st">"nonsense_mediated_decay"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"protein_coding"</span>, <span class="st">"retained_intron"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  transcript_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"Transcript1"</span>, <span class="st">"Transcript2"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Transcript3"</span>, <span class="st">"Transcript4"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Transcript5"</span>, <span class="st">"Transcript6"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Transcript7"</span>, <span class="st">"Transcript8"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Transcript9"</span>, <span class="st">"Transcript10"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Transcript11"</span>, <span class="st">"Transcript12"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  log2FC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fl">1.5</span>, <span class="op">-</span><span class="fl">2.0</span>, <span class="fl">0.8</span>, <span class="op">-</span><span class="fl">1.2</span>, <span class="fl">2.3</span>, <span class="op">-</span><span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>    <span class="fl">1.0</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="fl">0.3</span>, <span class="op">-</span><span class="fl">2.5</span>, <span class="fl">1.8</span>, <span class="op">-</span><span class="fl">0.7</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sample gene sets</span></span></span>
<span class="r-in"><span><span class="va">genesets_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Pathway1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA"</span>, <span class="st">"GeneC"</span>, <span class="st">"GeneF"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Pathway2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneB"</span>, <span class="st">"GeneD"</span>, <span class="st">"GeneE"</span>, <span class="st">"GeneX"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sample transcript to gene mapping</span></span></span>
<span class="r-in"><span><span class="va">tx_to_gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  transcript_name <span class="op">=</span> <span class="va">det_df</span><span class="op">$</span><span class="va">transcript_name</span>,</span></span>
<span class="r-in"><span>  gene_name <span class="op">=</span> <span class="va">det_df</span><span class="op">$</span><span class="va">gene_name</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run enrichment analysis</span></span></span>
<span class="r-in"><span><span class="va">fgsea_results_df</span> <span class="op">&lt;-</span> <span class="fu">run_enrichment</span><span class="op">(</span></span></span>
<span class="r-in"><span>  det_df <span class="op">=</span> <span class="va">det_df</span>,</span></span>
<span class="r-in"><span>  genesets_list <span class="op">=</span> <span class="va">genesets_list</span>,</span></span>
<span class="r-in"><span>  tx_to_gene <span class="op">=</span> <span class="va">tx_to_gene</span>,</span></span>
<span class="r-in"><span>  pval_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>  lfc_cutoff <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fgsea_results_df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empty data.table (0 rows and 9 cols): pathway,pval,padj,log2err,ES,NES...</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lucio Rezende Queiroz, Lucio Rezende Queiroz, Izabela Mamede Conceicao, Luigi Marchionni, Gloria Franco.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

